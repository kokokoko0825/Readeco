# リリースノートの使い方

このドキュメントでは、Readeco アプリのリリースノート機能の使い方について説明します。

## 概要

リリースノートは、アプリの新機能や変更点をユーザーに通知するための機能です。

- **自動表示**: 新しいバージョンがリリースされると、ユーザーが設定画面を開いた際に自動でリリースノートモーダルが表示されます
- **手動確認**: 設定画面の「アプリについて」→「リリースノート」から、いつでも確認できます

## リリースノートデータの場所

リリースノートのデータは以下のファイルにあります：

```
app/(tabs)/Settings.tsx
```

```
components/constants/release-notes.ts
```
にもある

ファイル内の `RELEASE_NOTES` 配列を編集します。

## データ形式

```typescript
const RELEASE_NOTES = [
  {
    version: '1.1.0',      // バージョン番号（app.json の version と一致させる）
    date: '2024-02-01',    // リリース日（YYYY-MM-DD形式）
    changes: [             // 変更点の配列
      '新機能: XXX を追加',
      '改善: YYY の動作を改善',
      'バグ修正: ZZZ を修正',
    ],
  },
  // 古いバージョンは下に続く...
];
```

## 新しいバージョンをリリースする手順

### 1. app.json のバージョンを更新

```json
{
  "expo": {
    "version": "1.1.0"  // ← 新しいバージョン番号に更新
  }
}
```

### 2. RELEASE_NOTES に新しいエントリを追加

`app/(tabs)/Settings.tsx` を開き、`RELEASE_NOTES` 配列の**先頭**に新しいエントリを追加します：

```typescript
const RELEASE_NOTES = [
  // ↓ 新しいエントリを先頭に追加
  {
    version: '1.1.0',
    date: '2024-02-01',
    changes: [
      '新機能: Google Books API によるフォールバック検索',
      '改善: バーコードスキャナーの連続スキャン機能',
      'UI改善: 設定画面に法的情報セクションを追加',
    ],
  },
  // ↓ 既存のエントリ
  {
    version: '1.0.0',
    date: '2024-01-15',
    changes: [
      '初回リリース',
      'バーコードスキャンによる本の登録機能',
      '本棚管理機能',
      'フレンド機能',
    ],
  },
];
```

### 3. アプリをビルド・リリース

通常のリリースフローに従ってアプリをビルドし、ストアに公開します。

## 変更点の書き方のガイドライン

### プレフィックスの推奨

| プレフィックス | 用途 |
|--------------|------|
| `新機能:` | 新しく追加された機能 |
| `改善:` | 既存機能の改善・強化 |
| `バグ修正:` | バグの修正 |
| `UI改善:` | ユーザーインターフェースの改善 |
| `パフォーマンス:` | 速度・効率の向上 |
| `セキュリティ:` | セキュリティ関連の修正 |

### 良い例

```typescript
changes: [
  '新機能: ダークモードに対応',
  '改善: 本の検索速度を向上',
  'バグ修正: 特定の ISBN が読み取れない問題を修正',
  'UI改善: 本棚のグリッド表示を追加',
]
```

### 避けるべき例

```typescript
changes: [
  'バグを修正しました',           // 具体性がない
  'いくつかの改善を行いました',    // 何が改善されたか不明
  'コードをリファクタリング',      // ユーザーには関係ない技術的な変更
]
```

## 自動表示の仕組み

1. ユーザーが設定画面を開く
2. アプリは現在のバージョン（`app.json` の `version`）を取得
3. AsyncStorage に保存された「最後に確認したバージョン」と比較
4. バージョンが異なる場合（新しいバージョン or 初回訪問）、リリースノートモーダルを自動表示
5. 表示後、現在のバージョンを AsyncStorage に保存

## テスト方法

開発中にリリースノートの自動表示をテストするには：

### 方法1: AsyncStorage をクリア

```typescript
// 開発用：AsyncStorage のバージョン情報をクリア
import AsyncStorage from '@react-native-async-storage/async-storage';
await AsyncStorage.removeItem('@readeco_last_seen_version');
```

### 方法2: app.json のバージョンを一時的に変更

1. `app.json` の `version` を一時的に変更（例：`1.0.0` → `1.0.1`）
2. アプリを再起動して設定画面を開く
3. テスト後、元に戻す

## 注意事項

- `version` は必ず `app.json` の `version` と一致させてください
- 新しいエントリは必ず配列の**先頭**に追加してください（最新が上に表示されます）
- `date` は `YYYY-MM-DD` 形式で記述してください
- `changes` 配列は空にしないでください（最低1つの変更点を記載）

## 関連ファイル

| ファイル | 説明 |
|---------|------|
| `app/(tabs)/Settings.tsx` | リリースノートデータ・表示ロジック |
| `app.json` | アプリバージョン設定 |
